{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"41633959-4ab3a3c79df0d7e6ffc2251eb\";\n\nconst form = document.querySelector(\".form\");\nconst photoContainer = document.querySelector(\".photo-container\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\nlet gallery;\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalHits = 0;\nlet cardHeight = 0; \n\n\nloadMoreBtn.style.display = \"none\";\n\nconst getBaseUrl = () => {\n    const url = new URL(BASE_URL);\n    url.searchParams.append(\"key\", API_KEY);\n    url.searchParams.append(\"image_type\", \"photo\");\n    url.searchParams.append(\"orientation\", \"horizontal\");\n    url.searchParams.append(\"safesearch\", \"true\");\n    url.searchParams.append(\"page\", currentPage);\n    url.searchParams.append(\"per_page\", 40); \n\n    return url;\n};\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    const query = event.currentTarget.elements[0].value;\n\n    if (query.length < 4) {\n        alert(\"Sorry, Yours length is not enough. Min 4 letters.\");\n    } else {\n        loader.style.display = \"block\";\n        loadMoreBtn.style.display = \"none\"; \n        currentQuery = query.toLowerCase();\n        currentPage = 1; \n        try {\n            await renderPhoto();\n        } catch (error) {\n            console.error(error);\n        }\n    }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    loader.style.display = \"block\";\n    currentPage++;\n    try {\n        await renderPhoto();\n    } catch (error) {\n        console.error(error);\n    }\n});\n\nconst getPhoto = async () => {\n    const url = getBaseUrl();\n    url.searchParams.append(\"q\", currentQuery);\n\n    try {\n        const response = await axios.get(url.toString());\n\n        if (response.status === 200) {\n            return response.data;\n        } else {\n            throw new Error(\"Request is not okay\");\n        }\n    } catch (error) {\n        console.error(error);\n    }\n};\n\nconst renderPhoto = async () => {\n    try {\n        const images = await getPhoto();\n\n        if (images.hits.length === 0 && currentPage === 1) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight'\n            });\n            loader.style.display = \"none\";\n            return;\n        } else if (images.hits.length === 0) {\n            iziToast.info({\n                message: 'We\\'re sorry, but you\\'ve reached the end of search results.',\n                position: 'topRight'\n            });\n            loader.style.display = \"none\";\n            loadMoreBtn.style.display = \"none\";\n            return;\n        }\n\n        totalHits = images.totalHits;\n\n        if (currentPage === 1) {\n            const firstCard = document.querySelector('.photo-card');\n            if (firstCard) {\n                const cardRect = firstCard.getBoundingClientRect();\n                cardHeight = cardRect.height;\n            }\n        }\n\n        const photoList = images.hits.reduce((html, hit, index) => {\n            return html +\n                `<div class=\"photo-card\">\n                    <div class=\"photo\">\n                        <a href=\"${hit.largeImageURL}\" data-lightbox=\"gallery-${index}\">\n                            <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" width=\"360\" height=\"200\" />\n                        </a>\n                    </div>\n                    <div class=\"info-container\">\n                        <div class=\"label-value\">\n                            <div class=\"label-likes\">Likes</div>\n                            <div class=\"value\">${hit.likes}</div>\n                        </div>\n                        <div class=\"label-value\">\n                            <div class=\"label-likes\">Views</div>\n                            <div class=\"value\">${hit.views}</div>\n                        </div>\n                        <div class=\"label-value\">\n                            <div class=\"label-likes\">Comments</div>\n                            <div class=\"value\">${hit.comments}</div>\n                        </div>\n                        <div class=\"label-value\">\n                            <div class=\"label-likes\">Downloads</div>\n                            <div class=\"value\">${hit.downloads}</div>\n                        </div>\n                    </div>\n                </div>`;\n        }, '');\n\n        if (currentPage === 1) {\n            photoContainer.innerHTML = photoList;\n        } else {\n            photoContainer.innerHTML += photoList;\n        }\n\n        loader.style.display = \"none\";\n\n        loadMoreBtn.style.display = currentPage * 40 >= totalHits ? \"none\" : \"block\";\n\n        gallery = new SimpleLightbox('.photo a', {\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n        });\n        gallery.refresh();\n\n      \n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth'\n        });\n    } catch (error) {\n        console.error(error);\n    }\n};\n\nwindow.scrollBy(0, window.innerHeight);\nwindow.scrollBy(0, -window.innerHeight);\nwindow.scrollBy({\n    top: 100,\n    left: 100,\n    behavior: \"smooth\",\n});\n"],"names":["BASE_URL","API_KEY","form","photoContainer","loader","loadMoreBtn","gallery","currentPage","currentQuery","totalHits","cardHeight","getBaseUrl","url","event","query","renderPhoto","error","getPhoto","response","axios","images","iziToast","firstCard","photoList","html","hit","index","SimpleLightbox"],"mappings":"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"}