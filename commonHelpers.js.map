{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst api = axios.create({\n  baseURL: \"https://pixabay.com/api/\",\n  params: {\n    key: \"41633959-4ab3a3c79df0d7e6ffc2251eb\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n  },\n});\n\nconst form = document.querySelector(\".form\");\nconst photoContainer = document.querySelector(\".photo-container\");\nconst loader = document.querySelector(\".loader\");\nconst buttonLoadMore = document.querySelector(\".button-load-more\");\n\nlet gallery;\nlet page = 1;\nlet limit = 40;\nlet currentQuery = \"\";\nlet totalPages = 1;\n\nconst getPhoto = async (query = \"\") => {\n  try {\n    const response = await api.get(\"\", {\n      params: {\n        q: query,\n        page: page,\n        per_page: limit,\n      },\n    });\n\n    if (response.status === 200) {\n      totalPages = Math.ceil(response.data.totalHits / limit);\n      return response.data;\n    } else {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n  } catch (error) {\n    console.error(\"Error fetching data:\", error);\n    throw new Error(\"Error fetching data\");\n  }\n};\n\nfunction smoothScrollToNextGroup() {\n  const cardHeight = document.querySelector(\".photo-card\")?.getBoundingClientRect().height;\n  const scrollDistance = 2 * (cardHeight || 0); \n\n  window.scrollBy({\n    top: scrollDistance,\n    behavior: \"smooth\",\n  });\n}\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n\n  const query = event.currentTarget.elements[0].value;\n\n  if (query.length < 3) {\n    alert(\"Sorry, Yours length is not enough. Min 4 letters.\");\n  }\n  else {\n      \n    try {\n      currentQuery = query.toLowerCase();\n      page = 1;\n      await renderPhoto(currentQuery);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n});\n\nasync function renderPhoto(query) {\n  try {\n    buttonLoadMore.style.display = \"none\";\n    const images = await getPhoto(query);\n\n\n    if (images.hits.length === 0 && page === 1) {\n      \n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight'\n      });\n    }\n\n    if (page === 1) {\n      photoContainer.innerHTML = '';\n    }\n\n    const photoList = images.hits\n      .map((hit, index) => (\n        `<div class=\"photo-card\">\n          <div class=\"photo\">\n            <a href=\"${hit.largeImageURL}\" data-lightbox=\"gallery-${index}\">\n              <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" width=\"360\" height=\"200\" />\n            </a>\n          </div>\n          <div class=\"info\">\n            <div class=\"label-value\">\n              <div class=\"label\">Likes</div>\n              <div class=\"value\">${hit.likes}</div>\n            </div>\n            <div class=\"label-value\">\n              <div class=\"label\">Views</div>\n              <div class=\"value\">${hit.views}</div>\n            </div>\n            <div class=\"label-value\">\n              <div class=\"label\">Comments</div>\n              <div class=\"value\">${hit.comments}</div>\n            </div>\n            <div class=\"label-value\">\n              <div class=\"label\">Downloads</div>\n              <div class=\"value\">${hit.downloads}</div>\n            </div>\n          </div>\n        </div>`\n      ))\n      .join('');\n\n    photoContainer.insertAdjacentHTML(\"beforeend\", photoList);\n\n    gallery = new SimpleLightbox('.photo a', {\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n    gallery.refresh();\n\n    if (page > 1) {\n      smoothScrollToNextGroup();\n    }\n    \n    if (page < totalPages) {\n      buttonLoadMore.style.display = \"inline\";\n    }\n  } catch (error) {\n    console.error(error);\n  } \n}\nbuttonLoadMore.addEventListener(\"click\", async () => {\n  page += 1;\n  loader.style.display = \"block\";\n  try {\n    await renderPhoto(currentQuery);\n    if (page >= totalPages) {\n      \n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight'\n      });\n      buttonLoadMore.style.display = \"none\";\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = \"none\";\n  }\n});"],"names":["api","axios","form","photoContainer","loader","buttonLoadMore","gallery","page","limit","currentQuery","totalPages","getPhoto","query","response","error","smoothScrollToNextGroup","scrollDistance","_a","event","renderPhoto","images","iziToast","photoList","hit","index","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAMC,EAAM,OAAO,CACvB,QAAS,2BACT,OAAQ,CACN,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,MACb,CACH,CAAC,EAEKC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAiB,SAAS,cAAc,kBAAkB,EAC1DC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,mBAAmB,EAEjE,IAAIC,EACAC,EAAO,EACPC,EAAQ,GACRC,EAAe,GACfC,EAAa,EAEjB,MAAMC,EAAW,MAAOC,EAAQ,KAAO,CACrC,GAAI,CACF,MAAMC,EAAW,MAAMb,EAAI,IAAI,GAAI,CACjC,OAAQ,CACN,EAAGY,EACH,KAAML,EACN,SAAUC,CACX,CACP,CAAK,EAED,GAAIK,EAAS,SAAW,IACtB,OAAAH,EAAa,KAAK,KAAKG,EAAS,KAAK,UAAYL,CAAK,EAC/CK,EAAS,KAEhB,MAAM,IAAI,MAAM,8BAA8BA,EAAS,QAAQ,CAElE,OAAQC,EAAP,CACA,cAAQ,MAAM,uBAAwBA,CAAK,EACrC,IAAI,MAAM,qBAAqB,CACtC,CACH,EAEA,SAASC,GAA0B,OAEjC,MAAMC,EAAiB,KADJC,EAAA,SAAS,cAAc,aAAa,IAApC,YAAAA,EAAuC,wBAAwB,SACxC,GAE1C,OAAO,SAAS,CACd,IAAKD,EACL,SAAU,QACd,CAAG,CACH,CACAd,EAAK,iBAAiB,SAAU,MAAOgB,GAAU,CAC/CA,EAAM,eAAc,EAEpB,MAAMN,EAAQM,EAAM,cAAc,SAAS,GAAG,MAE9C,GAAIN,EAAM,OAAS,EACjB,MAAM,mDAAmD,MAIzD,IAAI,CACFH,EAAeG,EAAM,cACrBL,EAAO,EACP,MAAMY,EAAYV,CAAY,CAC/B,OAAQK,EAAP,CACA,QAAQ,MAAMA,CAAK,CACpB,CAEL,CAAC,EAED,eAAeK,EAAYP,EAAO,CAChC,GAAI,CACFP,EAAe,MAAM,QAAU,OAC/B,MAAMe,EAAS,MAAMT,EAASC,CAAK,EAG/BQ,EAAO,KAAK,SAAW,GAAKb,IAAS,GAEvCc,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,UAClB,CAAO,EAGCd,IAAS,IACXJ,EAAe,UAAY,IAG7B,MAAMmB,EAAYF,EAAO,KACtB,IAAI,CAACG,EAAKC,IACT;AAAA;AAAA,uBAEeD,EAAI,yCAAyCC;AAAA,0BAC1CD,EAAI,sBAAsBA,EAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAMrBA,EAAI;AAAA;AAAA;AAAA;AAAA,mCAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,mCAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,mCAIJA,EAAI;AAAA;AAAA;AAAA,eAIhC,EACA,KAAK,EAAE,EAEVpB,EAAe,mBAAmB,YAAamB,CAAS,EAExDhB,EAAU,IAAImB,EAAe,WAAY,CACvC,aAAc,MACd,gBAAiB,SACjB,aAAc,GACpB,CAAK,EACDnB,EAAQ,QAAO,EAEXC,EAAO,GACTQ,IAGER,EAAOG,IACTL,EAAe,MAAM,QAAU,SAElC,OAAQS,EAAP,CACA,QAAQ,MAAMA,CAAK,CACpB,CACH,CACAT,EAAe,iBAAiB,QAAS,SAAY,CACnDE,GAAQ,EACRH,EAAO,MAAM,QAAU,QACvB,GAAI,CACF,MAAMe,EAAYV,CAAY,EAC1BF,GAAQG,IAEVW,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,EACDhB,EAAe,MAAM,QAAU,OAElC,OAAQS,EAAP,CACA,QAAQ,MAAMA,CAAK,CACvB,QAAY,CACRV,EAAO,MAAM,QAAU,MACxB,CACH,CAAC"}